{{i18n_ns "files"}}

<div class="file_container image_container" style="width: {{image_width}}px;">

  <a data-file-id="{{file.id}}"
    data-src="{{image_src}}"
    href="{{file.url_private}}"
    target="{{file.url_private}}"
    style="width: {{image_width}}px;"
    class="file_body image_body image_{{file.filetype}}
      {{#if file.is_external}}file_viewer_external_link{{else}}file_viewer_channel_link file_viewer_link{{/if}}"
    data-link-url="{{file.url_private}}"

    {{#unless file.is_external}}
      title="{{~#if file_viewer~}}
        {{~#isMac~}}
          {{#t}}Open in File Viewer (cmd+click to open original in new tab){{/t}}
        {{~else~}}
          {{#t}}Open in File Viewer (ctrl+click to open original in new tab){{/t}}
        {{~/isMac~}}
      {{~else~}}
        {{~#isMac~}}
          {{#t}}cmd+click to open original in new tab{{/t}}
        {{~else~}}
          {{#t}}ctrl+click to open original in new tab{{/t}}
        {{~/isMac~}}
      {{~/if~}}"
    {{/unless}}>

    <div class="image_preserve_aspect_ratio">
      <figure class="image_bg" style="background-image:url('{{image_src}}');
        {{#if preserve_aspect_ratio}}
          padding-top: -webkit-calc( {{file.thumb_360_h}} / {{file.thumb_360_w}} * 100%); padding-top: -moz-calc( {{file.thumb_360_h}} / {{file.thumb_360_w}} * 100%); padding-top: calc( {{file.thumb_360_h}} / {{file.thumb_360_w}} * 100%);
        {{else}}
          width: {{file.thumb_360_w}}px; height: {{file.thumb_360_h}}px;
        {{/if}}">

        <img class="image_hide"
          {{#if image_lazyload}}
            data-real-src="{{image_src}}"
          {{else}}
            src="{{image_src}}"
          {{/if}}
        />

      </figure>
    </div>

  </a>

  {{#if is_message}}
    {{#if_equal file.mode compare='hosted'}}
      {{#fileDefaultIsNewWindow id=file.id}}
        {{! the default for images and pdfs is to open the original in a browser window }}
        {{> message_file_preview_actions file=file download=true main_action="new_window"}}
      {{else}}
        {{! the default for other files is to download }}
        {{> message_file_preview_actions file=file download=true main_action="download"}}
      {{/fileDefaultIsNewWindow}}
    {{else}}
      {{> message_file_preview_actions file=file main_action="new_window"}}
    {{/if_equal}}
  {{/if}}

</div>{{!--/file_container--}}
