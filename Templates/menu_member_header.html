{{i18n_ns "menu"}}

<div class="menu_member_header">
  <div class="member_details display_flex flex_direction_column align_items_flex_start cropped_preview">
    {{makeMemberPreviewCardLinkImage member.id}}

    {{#feature flag="feature_user_custom_status"}}
      {{#or member.profile.status_emoji member.profile.status_text}}
        <p class="member_current_status">
          <span class="member_current_status_label">{{#t}}Status{{/t}}</span>
          <span class="current_status">{{getMemberCurrentStatusForDisplay member}}</span>
        </p>
        <hr class="member_details_divider">
      {{/or}}
    {{/feature}}

    {{#unless member.is_stranger}}
      <p class="member_timezone_value">
        {{#experiment name="guest_profiles_and_expiration"}}
          {{#if member.is_bot}}
            <span class="float_right left_margin">
          {{/if}}
        {{else}}
          {{#or member.is_restricted member.is_bot}}
            <span class="float_right left_margin">
          {{/or}}
        {{/experiment}}
        <span class="timezone_label" data-member-id="{{member.id}}">{{memberLocalTime member}}</span>
        {{#if member.is_self}}
          (<a href='/account/settings' target="{{newWindowName}}" data-action="edit_member_profile_modal">{{#t note="A link to change your own timezone"}}change{{/t}}</a>)
        {{/if}}
        {{#experiment name="guest_profiles_and_expiration"}}
          {{#if member.is_bot}}
            </span>
          {{/if}}
        {{else}}
          {{#or member.is_restricted member.is_bot}}
            </span>
          {{/or}}
        {{/experiment}}
        {{#experiment name="guest_profiles_and_expiration"}}
        {{else}}
          {{#if member.is_restricted}}
            <span class="lato">
              <span class="overflow_ellipsis">
                {{#if member.is_ultra_restricted}}
                  {{#t}}Single-Channel Guest{{/t}}
                {{else}}
                  {{#t}}Multi-Channel Guest{{/t}}
                {{/if}}
              </span>
            </span>
          {{/if}}
        {{/experiment}}
        {{#if member.is_bot}}
          <span class="lato">
            <span class="overflow_ellipsis">{{#t note="Labelling a bot in the member card"}}Non-sentient Bot{{/t}}</span>
          </span>
        {{/if}}
      </p>
    {{/unless}}

    <div class="member_details_over_image">
      <div class="member_name_and_presence lato">
        {{#feature flag="feature_name_tagging_client"}}
          {{#if member.deleted}}
            <a href="/team/{{member.id}}" target={{newWindowName}} class="member_name" data-qa="member_name">{{getMemberFullName member}}</a>
          {{else}}
            {{#if member.is_self}}
              <a href="/team/{{member.id}}" target={{newWindowName}} class="member_name" data-qa="member_name">{{getMemberFullName member}}</a>
            {{else}}
              <a href="/messages/{{member.id}}" target="/messages/{{member.id}}" data-member-id="{{member.id}}" class="member_name internal_im_link" data-qa="member_name">{{getMemberFullName member}}</a>
            {{/if}}
            {{makeMemberPresenceIcon member}}
          {{/if}}
        {{else}}
          {{#if member.deleted}}
            <a href="/team/{{member.name}}" target={{newWindowName}} class="member_name" data-qa="member_name">{{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}@{{member.name}}{{/if}}</a>
          {{else}}
            {{#if member.is_self}}
              <a href="/team/{{member.name}}" target={{newWindowName}} class="member_name" data-qa="member_name">{{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}@{{member.name}}{{/if}}</a>
            {{else}}
              <a href="/messages/@{{member.name}}" target="/messages/@{{member.name}}" data-member-name="{{member.name}}" class="member_name internal_im_link" data-qa="member_name">{{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}@{{member.name}}{{/if}}</a>
            {{/if}}
            {{makeMemberPresenceIcon member}}
          {{/if}}
        {{/feature}}
      </div>

      {{#if member.profile}}
        {{#if member.profile.title}}
          <div class="member_title lato">{{member.profile.title}}</div>
        {{/if}}
      {{/if}}
    </div>

    {{#experiment name="guest_profiles_and_expiration"}}
      {{#if member.is_restricted}}
        <div class="member_restriction_over_image">
          <span class="overflow_ellipsis lato_black">
            {{#if member.is_ultra_restricted}}
              <i aria-hidden="true" class="ts_icon ts_icon_presence_ura presence_icon"></i>
            {{else}}
              <i aria-hidden="true" class="ts_icon ts_icon_presence_ra presence_icon"></i>
            {{/if}}
            {{#if member.deleted}}
              {{#t note="Refers to deactivated account"}}Deactivated{{/t}}
            {{/if}}
            {{#if member.is_ultra_restricted}}
              {{#t}}Single-Channel Guest{{/t}}
            {{else}}
              {{#t}}Multi-Channel Guest{{/t}}
            {{/if}}
          </span>
        </div>
      {{/if}}
    {{/experiment}}

  </div>

  <hr class="member_details_divider">
</div>
