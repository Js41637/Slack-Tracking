<div class="file_container generic_container">

  <a data-file-id="{{file.id}}"
    target="{{#isClient}}{{newWindowName}}{{else}}_blank{{/isClient}}"
    class="file_header generic_header {{#if_equal file.mode compare='hosted'}}{{#fileDefaultIsNewWindow id=file.id}}{{else}}file_ssb_download_link{{/fileDefaultIsNewWindow}}{{/if_equal}} {{#nonImageCanUseFSFV file}}file_viewer_channel_link file_viewer_link{{/nonImageCanUseFSFV}}"

    {{#if_equal file.mode compare='hosted'}}
      {{#fileDefaultIsNewWindow id=file.id}}
        href="{{file.url_private}}"
      {{else}}
        href="{{file.url_private_download}}"
      {{/fileDefaultIsNewWindow}}
    {{else}}
      href="{{file.url_private}}"
    {{/if_equal}}
  >

    <i class="file_header_icon generic_header_icon filetype_icon {{file.filetype}} s48">
      {{#fileIconTypeDownload file}}
        <i class="ts_icon ts_icon_arrow_down {{file.filetype}}"></i>
      {{else}}
        {{#nonImageCanUseFSFV file}}
          <i class="ts_icon ts_icon_search_small {{file.filetype}}"></i>
        {{else}}
          <i class="ts_icon ts_icon_arrow_ne_medium {{file.filetype}}"></i>
        {{/nonImageCanUseFSFV}}
      {{/fileIconTypeDownload}}
    </i>

    <h4 class="file_header_title generic_header_title overflow_ellipsis">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</h4>

    <p class="file_header_meta generic_header_meta">
      {{#if filesize}}
        <span class="meta_size">{{convertFilesize file.size}}</span><span class="meta_hover_placement">
        <span class="meta_type overflow_ellipsis">{{#if file.is_external}}{{{makeExternalFiletypeHTML file}}}{{else}}{{file.pretty_type}}{{/if}}</span>
      {{else}}
        <span class="meta_hover_placement"><span class="meta_type overflow_ellipsis">{{#if file.is_external}}{{{makeExternalFiletypeHTML file}}}{{else}}{{file.pretty_type}}{{/if}}</span>
      {{/if}}

      <span class="meta_hover overflow_ellipsis">
        {{#if_equal file.mode compare='hosted'}}
          {{#fileDefaultIsNewWindow id=file.id}}
            {{#nonImageCanUseFSFV file}}
              Click to view
            {{else}}
              Click to open original
            {{/nonImageCanUseFSFV}}
          {{else}}
            Click to download
          {{/fileDefaultIsNewWindow}}
        {{else}}
          Click to open in
            {{#if_equal file.external_type compare="gdrive"}}Google\u00a0Drive{{/if_equal}}
            {{#if_equal file.external_type compare="dropbox"}}Dropbox{{/if_equal}}
            {{#if_equal file.external_type compare="box"}}Box{{/if_equal}}
            {{#if_equal file.external_type compare="onedrive"}}OneDrive{{/if_equal}}
            {{#if_equal file.external_type compare="unknown"}}a\u00a0web\u00a0page{{/if_equal}}
        {{/if_equal}}
      </span></span>
    </p>

  </a>

  {{#if is_message}}
    {{#if_equal file.mode compare='hosted'}}
      {{#fileDefaultIsNewWindow id=file.id}}
        {{! the default for images and pdfs is to open the original in a browser window }}
        {{> message_file_preview_actions file=file download=true main_action="new_window"}}
      {{else}}
        {{! the default for other files is to download }}
        {{> message_file_preview_actions file=file download=true main_action="download"}}
      {{/fileDefaultIsNewWindow}}
    {{else}}
      {{> message_file_preview_actions file=file main_action="new_window"}}
    {{/if_equal}}
  {{/if}}

  {{#feature flag="feature_inline_media_playback"}}
    {{#if file_is_video}}
      <video class="inline_video" controls preload="{{video_preload}}" height="{{video_height}}" src="{{best_source}}">
        Your browser does not support HTML5 Video. Try <a href="http://browsehappy.com/">a modern browser</a>.
      </video>
    {{/if}}
    {{#if file_is_audio}}
      <audio controls preload="{{audio_preload}}" src="{{file.url_private}}">
        Your browser does not support HTML5 Audio. Try <a href="http://browsehappy.com/">a modern browser</a>.
      </audio>
    {{/if}}
  {{/feature}}

</div>{{!--/file_container--}}
